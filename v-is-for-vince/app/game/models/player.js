"use strict";var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},game_object_1=require("../../engine/models/game-object"),laser_module_1=require("../modules/laser-module"),velocity_module_1=require("../../engine/modules/velocity-module"),physics_module_1=require("../../engine/modules/physics-module"),basic_keyboard_movement_1=require("../../engine/input-controllers/basic-keyboard-movement"),keyboard_input_1=require("../../engine/input-controllers/keyboard-input"),hitpoint_module_1=require("../modules/hitpoint-module"),Player=function(e){function t(t){e.call(this),this.LASER_ACCEL=5e3,this.LASER_SPEED=750,this.HP_MAX=50,this.x=t.startX,this.y=t.startY,this.radius=t.radius,this.colorA=t.colorA,this.colorB=t.colorB,this.hpModule=new hitpoint_module_1.default(this.HP_MAX),this.addModule(this.hpModule),this.addModule(new laser_module_1.default(t.fireKey,this.LASER_ACCEL,this.LASER_SPEED)),this.addModule(new physics_module_1.PhysicsModule(this)),this.velocityModule=new velocity_module_1.default(t.speed,t.acceleration,t.deceleration),this.addModule(this.velocityModule),this.keyboardMapping=new basic_keyboard_movement_1.BasicKeyboardMovementMapping(this.velocityModule,t.movementKeys)}return __extends(t,e),t.prototype.attach=function(t){e.prototype.attach.call(this,t);var i=t.getInputController(keyboard_input_1.default);void 0!=i&&i.attachKeyboardMapping(this.keyboardMapping)},t.prototype.detach=function(t){e.prototype.detach.call(this,t);var i=t.getInputController(keyboard_input_1.default);void 0!=i&&i.removeKeyboardMapping(this.keyboardMapping)},t.prototype.render=function(e){e.strokeStyle="#000",e.lineWidth=4,e.fillStyle=this.colorA,e.beginPath(),e.arc(this.x,this.y,this.radius,0,2*Math.PI),e.fill(),e.stroke(),e.closePath(),e.beginPath();var t=this.x+15*Math.cos(this.velocityModule.angle),i=this.y+15*Math.sin(this.velocityModule.angle);e.fillStyle=this.colorB,e.lineWidth=2,e.arc(t,i,this.radius/2,0,2*Math.PI),e.stroke(),e.fill(),e.closePath();var o=this.y-this.radius-20,s=2*this.radius*(this.hpModule.points/this.hpModule.maxPoints);e.fillRect(this.x-this.radius,o,s,10)},t.prototype.getBodyDefinition=function(){var e=new PhysicsType2d.Dynamics.BodyDefinition;e.type=PhysicsType2d.Dynamics.BodyType.DYNAMIC;var t=physics_module_1.PhysicsConversions.toMetres(this.x),i=physics_module_1.PhysicsConversions.toMetres(this.y);return e.position=new PhysicsType2d.Vector2(t,i),e.linearDamping=.1,e},t.prototype.getFixtures=function(){var e=new PhysicsType2d.Dynamics.FixtureDefinition,t=new PhysicsType2d.Collision.Shapes.CircleShape,i=physics_module_1.PhysicsConversions.toMetres(this.radius);return t.m_radius=i,e.shape=t,e.density=.25,[e]},t}(game_object_1.default);Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=Player;
//# sourceMappingURL=player.js.map
