{"version":3,"sources":["game/modules/laser-module.ts"],"names":["module_1","require","velocity_module_1","keyboard_mapping_1","keyboard_input_1","laser_1","LaserGunModule","_super","fireKey","acceleration","speed","call","this","__extends","prototype","onAttach","parent","context","_this","keyMapping","default","registerOnDown","fireLaser","controller","getInputController","attachKeyboardMapping","onDetach","removeKeyboardMapping","gameObject","module","getModule","velocityModule","laser","angle","x","y","spawn","Object","defineProperty","exports","value"],"mappings":"sNAAAA,SAAAC,QAAmB,+BAEnBC,kBAAAD,QAA2B,wCAC3BE,mBAAAF,QAAgC,mDAChCG,iBAAAH,QAA+B,iDAE/BI,QAAAJ,QAAkB,mBAElBK,eAAA,SAAAC,GAOE,QAAAD,GAAYE,EAAiBC,EAAsBC,GACjDH,EAAAI,KAAAC,MACAA,KAAKJ,QAAUA,EACfI,KAAKH,aAAeA,EACpBG,KAAKF,MAAQA,EA2BjB,MAtC4CG,WAAAP,EAAAC,GAc1CD,EAAAQ,UAAAC,SAAA,SAASC,EAAoBC,GAA7B,GAAAC,GAAAN,IACEA,MAAKO,WAAa,GAAIhB,oBAAAiB,QACtBR,KAAKO,WAAWE,eAAeT,KAAKJ,QAAS,WAAM,MAAAU,GAAKI,UAAUN,IAClE,IAAIO,GAAaN,EAAQO,mBAAmBpB,iBAAAgB,QAC1B,OAAdG,GACFA,EAAWE,sBAAsBb,KAAKO,aAI1Cb,EAAAQ,UAAAY,SAAA,SAASV,EAAoBC,GAC3B,GAAIM,GAAaN,EAAQO,mBAAmBpB,iBAAAgB,QAC1B,OAAdG,GACFA,EAAWI,sBAAsBf,KAAKO,aAI1Cb,EAAAQ,UAAAQ,UAAA,SAAUM,GACR,GAAIC,GAASD,EAAWE,UAAU5B,kBAAAkB,QAClC,IAAc,MAAVS,EAAgB,CAClB,GAAIE,GAAiBF,EACjBG,EAAQ,GAAI3B,SAAAe,QAAMR,KAAKH,aAAcsB,EAAeE,MAAOrB,KAAKF,MAAOkB,EAAWM,EAAGN,EAAWO,EACpGP,GAAWQ,MAAMJ,KAGvB1B,GAtC4CN,SAAAoB,QAA5CiB,QAAAC,eAAAC,QAAA,cAAAC,OAAA","file":"laser-module.js","sourcesContent":["import Module from '../../engine/modules/module'\nimport GameObject from '../../engine/models/game-object'\nimport VelocityModule from '../../engine/modules/velocity-module'\nimport BaseKeyboardMapping from '../../engine/input-controllers/keyboard-mapping'\nimport KeyboardController from '../../engine/input-controllers/keyboard-input'\nimport GameContext from '../../engine/models/game-context'\nimport Laser from '../models/laser'\n\nexport default class LaserGunModule extends Module {\n\n  fireKey: string;\n  acceleration: number;\n  speed: number;\n  keyMapping: BaseKeyboardMapping;\n\n  constructor(fireKey: string, acceleration: number, speed: number) {\n    super();\n    this.fireKey = fireKey;\n    this.acceleration = acceleration;\n    this.speed = speed;\n  }\n\n  onAttach(parent: GameObject, context: GameContext): void {\n    this.keyMapping = new BaseKeyboardMapping();\n    this.keyMapping.registerOnDown(this.fireKey, () => this.fireLaser(parent));\n    let controller = context.getInputController(KeyboardController) as KeyboardController\n    if (controller != null) {\n      controller.attachKeyboardMapping(this.keyMapping);\n    }\n  }\n\n  onDetach(parent: GameObject, context: GameContext): void {\n    let controller = context.getInputController(KeyboardController) as KeyboardController\n    if (controller != null) {\n      controller.removeKeyboardMapping(this.keyMapping);\n    }\n  }\n\n  fireLaser(gameObject: GameObject): void {\n    let module = gameObject.getModule(VelocityModule);\n    if (module != null) {\n      let velocityModule = module as VelocityModule;\n      let laser = new Laser(this.acceleration, velocityModule.angle, this.speed, gameObject.x, gameObject.y);\n      gameObject.spawn(laser);\n    }\n  }\n}\n"]}